<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>ME PLAYER</title>
	<link rel="stylesheet" href="./src/me-player.css" />
	<style>
		html, body {
				display: flex;
				justify-content: center;
				align-items: flex-start;
				width: 100%;
				height: 100%;
				margin: 0;
				padding-top: 40px;
				background-color: #f2f2f2;
		}
		</style>
</head>

<body>
	<div class="mep__container">
		<div class="mep__video-box">
			<video class="mep__video">
				<source src="./video/note8.mp4" type="video/mp4" />
			</video>
		</div>
		<div class="mep__controls">
			<button class="mep__button mep__play-button">
				<svg class="mep__svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22">
					<path class="mep-svg-fill" d="M17.982 9.275L8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z" />
				</svg>
				<svg class="mep__svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22">
					<path class="mep-svg-fill" d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zM15 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"></path>
				</svg>
			</button>
			<div class="mep__progress">
				<div class="mep__progress-bar"></div>
			</div>
			<div class="mep__time-display">
				<span class="mep__time-current">00:00</span>
				<span class="mep__time-divider">/</span>
				<span class="mep__time-total">00:00</span>
			</div>
			<button class="mep__button mep__mute-button">
				<svg class="mep__svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22">
					<path class="mep-svg-fill" d="M10.188 4.65L6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zm4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z" />
					<path class="mep-svg-fill" d="M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z" /></svg>
			</button>
			<button class="mep__button mep__fullscreen-button">
				<svg class="mep__svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22">
					<path class="mep-svg-fill" d="M9 3H4a1 1 0 0 0-1 1v5a1 1 0 0 0 2 0V5h4a1 1 0 0 0 0-2zM18 12a1 1 0 0 0-1 1v4h-4a1 1 0 0 0 0 2h5a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1z"></path>
				</svg>
			</button>
		</div>
	</div>

	<script>
		function $(selector) {
			return document.querySelector(selector)
		}

		const player = $(".mep__container")
		const video = player.querySelector("video.mep__video")
		const progress = player.querySelector('.mep__progress-bar')
		const totalTimeText = player.querySelector('.mep__time-total')
		const currentTimeText = player.querySelector('.mep__time-current')

		const ONE_MINUTE = 60

		function padLeft(num) {
			return num > 10 ? "" + num : "0" + num
		}

		function timeToString(seconds) {
			let totalSeconds = Math.round(seconds)
			let minutes = totalSeconds / ONE_MINUTE
			let remainSeconds = totalSeconds % ONE_MINUTE

			return `${ minutes >= 1 ? padLeft(minutes) : "00" }:${padLeft(remainSeconds)}`
		}

		function toggleVideoPlay() {
			if (video.paused) {
				video.play()
				player.classList.toggle("is-playing")
			} else {
				video.pause()
				player.classList.toggle("is-playing")
			}
		}

		function getButtonByClass(node, className) {
			if (node.classList.contains(className)) {
				return node
			} else {
				if (node.parentElement) {
					return getButtonByClass(node.parentElement, className)
				} else {
					return null
				}
			}
		}

		player.addEventListener("click", event => {
			const target = event.target
			const playBtn = getButtonByClass(target, "mep__play-button")
			if (playBtn) {
				toggleVideoPlay()
			}
		}, false)

		video.addEventListener("loadedmetadata", event => {
			const {
				duration
			} = video
			totalTimeText.textContent = timeToString(duration)
		})

		video.addEventListener("timeupdate", event => {
			const {
				currentTime,
				duration
			} = video
			const scaleX = (currentTime / duration)

			progress.style.transform = `scaleX(${scaleX})`
			currentTimeText.textContent = timeToString(currentTime)
		})

	</script>

</body>

</html>
